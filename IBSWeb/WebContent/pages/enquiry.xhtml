<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"   
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core">
      

    <h:body>
    	
    	<ui:composition template="/template/common/commonLayout.xhtml">
    	
    	
    	
    		<ui:define name="content">
    			
    			
    			<h:form>
    				
    				<h2>Pending Referral Tasks</h2>  
    			   			
    				<p:dataTable id ="taskTable" var="task" value="#{loginBean.taskDataModel}" paginator="true" rows="5"  
                 	selection="#{enquirySearchMB.referralTask}" selectionMode="single">  
                 
	                   <p:ajax event="rowSelect" listener="#{editCustEnqDetailsMB.onTaskSelect}"/> 
	                    
				        <p:column headerText="Enquiry Number">  
				            <h:outputText value="#{task.enquiry.enquiryNo}" />  
				        </p:column> 
				        
				        <p:column headerText="Customer name">  
				            <h:outputText value="#{task.enquiry.customerDetails.name}" />  
				        </p:column> 
				        
				        <p:column headerText="Customer ID">  
				            <h:outputText value="#{task.enquiry.customerDetails.customerId}" />  
				        </p:column> 
				  
				        <p:column headerText="Referral description">  
				            <h:outputText value="#{task.desc}" />  
				        </p:column>
				        
				        <p:column headerText="Assigned by">  
				            <h:outputText value="#{task.assignerUser.userName}" />  
				        </p:column>
			        
	    			</p:dataTable> 
    		
    				<h2>Enquiry Search</h2>
    			 
				    <p:panel id="panel" header="Search" style="margin-bottom:10px;">  
				          
				        <h:panelGrid columns="6" style="width:100%;">  
				            <h:outputLabel for="customerID" value="Customer Name" />  
				            <p:inputText id="customerID" value="#{enquirySearchMB.custName}" required="false" />  
				  
				            <h:outputLabel for="mobileNumberID" value="Mobile Number" />  
				            <p:inputText id="mobileNumberID" value="#{enquirySearchMB.mobNumber}" 
				            required="false" label="Mobile Number"  requiredMessage="Please enter the MobileNumber" converterMessage="Alphabets are not allowed , Please Enter the Correct Mobile Number" validatorMessage="MobileNumber should be of 8 digits">
							<f:convertNumber integerOnly="true" type="number" for="mobileNumberID" pattern="###"/>
							<f:validateLength minimum="8" maximum="8"  for="mobileNumberID"/>  
							</p:inputText>
				            
				            <h:outputLabel for="emailID" value="EmailID" />  
				            <p:inputText id="emailID" value="#{enquirySearchMB.emailID}" required="false" >
							<f:validator validatorId="custom.stringValidator" /> 
					   		</p:inputText> 
				            
				            <p:outputLabel for="insuredID" value="Insured Name" />  
				            <p:inputText id="insuredID"  value="#{enquirySearchMB.insuredName}" required="false" /> 
				            
				            <h:outputLabel for="enquiryID" value="Enquiry Number" />  
				            <p:inputText id="enquiryID" value="#{enquirySearchMB.enquiryNumber}"  
				            required="false" converterMessage="Enquiry Number should be a Number" >
							<f:convertNumber integerOnly="true" type="number" for="enquiryID" pattern="###"/>
							</p:inputText> 
				  
				            <h:outputLabel for="quoteSlipID" value="QuoteSlip Number" />  
				            <p:inputText id="quoteSlipID" value="#{enquirySearchMB.quoteSlipNumber}" 
				            required="false" converterMessage="QuoteSlip Number should be a Number" >
							<f:convertNumber integerOnly="true" type="number" for="quoteSlipID" pattern="###"/>
							</p:inputText>   
				            
				            <h:outputLabel for="policyNumber" value="Policy Id" />
				            <p:inputText id="policyNumber" value="#{enquirySearchMB.policyNumber}" 
				           	required="false" converterMessage="Policy Number should be a Number" >
							<f:convertNumber integerOnly="true" type="number" for="policyNumber" pattern="###"/>
							</p:inputText>   
				            
				        </h:panelGrid> 
				    </p:panel>  
				    
			 		<p:commandButton id="searchbtn" value="Search" action="#{enquirySearchMB.submit}"  ajax="true"  update="panel,searchDataTableID" style="margin-right:20px;" /> 
			 
			 		<p:commandButton id="newenquirybtn" value="New Enquiry" action="#{enquirySearchMB.newEnquiry}" style="margin-right:20px;" />  <br></br><br></br>

			 
			 
			 <p:dataTable id ="searchDataTableID" var="esb" value="#{enquirySearchMB.searchItemVODataModel}" paginator="true" rows="5"  
                 selection="#{enquirySearchMB.searchItem}" selectionMode="single">
                 
                   <p:ajax event="rowSelect" listener="#{editCustEnqDetailsMB.onRowSelect}"/> 
                    
		        <p:column headerText="CustomerName">  
		            <h:outputText value="#{esb.customerName}" />  
		        </p:column>  
		  
		        <p:column headerText="MobileNumber">  
		            <h:outputText value="#{esb.customerMob}" />  
		        </p:column> 
		        
		        <p:column headerText="EmailID">  
		            <h:outputText value="#{esb.customerEmail}" />  
		        </p:column> 
		  
		        <p:column headerText="InsuredName">  
		            <h:outputText value="#{esb.insuredName}" />  
		        </p:column>  
		  
		        <p:column headerText="EnquiryNumber">  
		            <h:outputText value="#{esb.enquiryNum}" />  
		        </p:column> 
		        
		        <p:column headerText="QuoteSlipNumber">  
		            <h:outputText value="#{esb.quotationNum}" />  
		        </p:column>  
		  
		        <p:column headerText="PolicyNumber">  
		            <h:outputText value="#{esb.policyNum}" />  
		        </p:column>  
		        
    		</p:dataTable> 
	 		<p:blockUI block="searchDataTableID" trigger="searchDataTableID">
				LOADING<br />  
      			<p:graphicImage value="../images/ajax-loader.gif"/>
  			</p:blockUI>
			 </h:form>  
    		</ui:define>
    				
    	</ui:composition>
    	
    </h:body>

</html>